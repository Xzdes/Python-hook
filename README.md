# hook\_server.py

Скрипт для захвата нажатий клавиш на клавиатуре c выдачей событий строго в английской раскладке, вне зависимости от текущей раскладки пользователя. Предназначен для работы со сканерами штрихкодов, кассовыми решениями и автоматизацией ввода в системах на базе Windows.

## Возможности

* Ловит все нажатия клавиш, включая спецсимволы, функциональные клавиши и NumPad
* Отображает английские символы вне зависимости от текущей языковой раскладки
* Все события выводятся в виде JSON в stdout (можно легко интегрировать в другие программы или модули Node.js)
* Нет зависимостей на мышь — только клавиатура
* Поддержка SHIFT и спецсимволов (например, `!@#$%^&*()_+`)
* События для служебных клавиш: Enter, Tab, Shift, Ctrl, Alt, Esc, F1–F12 и др.

## Требования

* Python 3.7+
* Windows (используется WinAPI для получения физических кодов клавиш)
* Библиотека [pynput](https://pypi.org/project/pynput/)

## Быстрый старт

1. **Установите зависимости**:

   ```bash
   pip install pynput
   ```

2. **Запустите скрипт:**

   ```bash
   python hook_server.py
   ```

   Все события появятся в консоли в виде JSON.

## Сборка EXE-файла

Для интеграции с Node.js/другими языками часто требуется запускать этот скрипт как отдельный бинарный файл (без установленного Python). Для этого используется PyInstaller:

**Главная команда для сборки бинарника:**

```bash
python -m PyInstaller --onefile --hidden-import=pynput.keyboard._win32 --hidden-import=pynput.keyboard._base hook_server.py
```

* В результате сборки в папке `dist/` появится исполняемый файл `hook_server.exe`.
* Можно копировать этот exe-файл в свой Node.js модуль, интегрировать с другими программами или запускать напрямую.

## Пример вывода

```json
{"type": "key_press", "key": "a"}
{"type": "key_press", "key": "F5"}
{"type": "key_press", "key": "ENTER"}
{"type": "key_press", "key": "!"}
```

## FAQ

**Q:** Находится ли текущий язык в системе важным?
**A:** Нет, скрипт всегда выводит символ в английской раскладке по физическому положению клавиши.

**Q:** Можно ли доработать под Linux/macOS?
**A:** В текущей реализации используется WinAPI, поэтому скрипт работает только под Windows.
